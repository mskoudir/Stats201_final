# stats201_final.py

This Python script implements a complete machine learning pipeline for the final project in STATS201 Machine Learning for Social Science. The code loads an e-commerce customer behavior dataset, preprocesses the data, builds a logistic regression model to predict customer satisfaction, evaluates the model, and produces several visualizations. The script is designed to be run as a standalone module or within a Jupyter Notebook environment.

## Features

- **Data Loading and Exploration:**  
  Loads the dataset (`ecommerce_customer_behavior.csv`), prints its shape, preview, missing values, and data types.

- **Data Preprocessing:**  
  - Drops rows with missing values in the "Satisfaction Level" column.
  - Creates a binary target variable (`Satisfied`) based on the satisfaction level.
  - Encodes categorical variables (`Gender`, `City`, `Membership Type`) using `LabelEncoder`.
  - Scales numerical features (e.g., `Age`, `Total Spend`, `Items Purchased`) using `StandardScaler`.

- **Model Development:**  
  Splits the data into training and test sets (70/30 split with stratification) and builds a logistic regression model using 5-fold cross-validation for robust performance evaluation.

- **Model Evaluation:**  
  Evaluates the model with accuracy, confusion matrix, classification report, and ROC curve (with AUC).

- **Feature Importance Visualization:**  
  Generates a bar chart of logistic regression coefficients to show the importance of each feature.

## How to Run

1. **Ensure that the dataset file** (`ecommerce_customer_behavior.csv`) is located in the same directory as this script or update the file path accordingly.

2. **Install Dependencies:**  
   Make sure you have installed the required Python libraries. You can install them using:
   ```bash
   pip install pandas numpy matplotlib seaborn scikit-learn
    ```
3. **Run the Script:**
   Execute the script from the command line:
   ```bash
   python stats201_final.py
    ```
Alternatively, open the script in a Jupyter Notebook cell and run it interactively.

## Dependencies

- Python 3.x
- pandas
- numpy
- matplotlib
- seaborn
- scikit-learn

## Code Overview

### Data Loading and Exploration:
- The script reads the CSV file.
- Displays the dataset shape, preview, missing values, and data types.

### Target Variable Creation:
- A binary target variable `Satisfied` is generated by mapping "Satisfied" from the "Satisfaction Level" column to 1 and all other values to 0.

### Data Preprocessing:
- Unnecessary columns ("Customer ID" and "Satisfaction Level") are dropped.
- Categorical features are encoded.
- Numeric features are scaled.

### Model Building and Evaluation:
- The code splits the data into training and test sets.
- Trains a logistic regression model with cross-validation.
- Prints accuracy scores and a classification report.
- Visualizes the confusion matrix and ROC curve.

### Feature Importance:
- Finally, the script plots a horizontal bar chart of the model's coefficients, providing insights into feature importance.
